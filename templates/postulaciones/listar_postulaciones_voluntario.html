<h2>Postulaciones para {{ user.username }}</h2>

<table>
    <thead>
        <tr>
            <th>Proyecto</th>
            <th>Estado</th>
            <th>Fecha de Postulación</th>
            <th>Motivación</th>
            <th>Acciones</th>
        </tr>
    </thead>
    <tbody>
        {% for postulacion in postulaciones %}
        <tr>
            <td>{{ postulacion.proyecto.title }}</td>
            <td>{{ postulacion.status }}</td>
            <td>{{ postulacion.applied_at }}</td>
            <td>{{ postulacion.motivation|default:"Sin mensaje" }}</td>
            <td>
                {% if user.is_authenticated and user.role == 'voluntario' %}
                    {% if postulacion.status == 'pendiente' %}
                        <span>Tu postulación está pendiente.</span>
                        <a href="{% url 'cancelar_postulacion' postulacion.id %}">Cancelar Postulación</a>
                        <a href="{% url 'editar_postulacion' postulacion.id %}">Editar Postulación</a>
                    {% elif postulacion.status == 'aceptada' %}
                        <span>Tu postulación ha sido aceptada.</span>
                        <a href="{% url 'cancelar_postulacion' postulacion.id %}">Cancelar Postulación</a>
                    {% elif postulacion.status == 'rechazada' %}
                        <span>Tu postulación ha sido rechazada.</span>
                        <a href="{% url 'crear_postulacion' proyecto.id %}">Re-Inscribirse</a>
                    {% endif %}
                {% endif %}
            </td>
        </tr>
        {% empty %}
        <tr>
            <td colspan="5">No hay postulaciones para este proyecto.</td>
        </tr>
        {% endfor %}
    </tbody>
</table>

<a href="{% url 'dashboard' %}">Volver a Proyectos</a>
